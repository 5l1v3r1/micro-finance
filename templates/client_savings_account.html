{% extends 'base.html' %}
{% block stage %}
<div class="home-div-gp">
  {% if user.is_admin %}
  <div class="wrap-cp-div">
    <div class="btn-row" style="margin-left:185px; margin-top:-10px;">
    <form id="clientsavingsaccountform"  class="form-horizontal" role="form" method="post">
      {% csrf_token %}
      <input type="hidden"  id="savingsaccount_id" value="{{savingsaccount.id}}" style="dispaly:none;">
      <input type="hidden"  id="client_id" value="{{client.id}}" style="dispaly:none;">
      <a href="#"><button><i class="fa fa-pencil-square-o padd"></i>Edit</button></a>
      {% if user.is_admin %}
      {% if savingsaccount.status == "Approved" %}
      <button title="Already Approved"><i class="fa fa-check-circle-o padd"></i>Approved</button>
      {% else %}
      <a href="{% url 'micro_admin:approvesavings' savingsaccount.id client.id %}"><button id="approve-button"><i class="fa fa-check-circle-o padd"></i>Approve</button></a>
      {% endif %}
      {% if savingsaccount.status == "Withdrawn" %}
      <button title="Already Withrawn"><i class="fa fa-arrow-circle-o-down"></i>Withdrawn</button>
      {% else %}
      <a href="{% url 'micro_admin:withdrawnsavings' savingsaccount.id client.id %}"><button id="withdraw-button"><i class="fa fa-arrow-circle-o-down"></i>Withdraw</button></a>
      {% endif %}
      {% if savingsaccount.status == "Rejected" %}
      <button title="Already Rejected"><i class="fa fa-times-circle-o padd"></i>Rejected</button>
      {% else %}
      <a href="{% url 'micro_admin:rejectsavings' savingsaccount.id client.id %}"><button id="reject-button"><i class="fa fa-times-circle-o padd"></i>Reject</button></a>
      {% endif %}
      {% endif %}
      <a href="#"><button><i class="fa fa-trash-o padd"></i>Close</button></a> 
      <br clear="all" />
    </form>
    </div>
  </div>
  {% endif %} 
  <div class="panel panel-default panel-hdg" style="margin-left:185px;">
    <div class="panel-heading">
      <h3 class="panel-title">
        {% if client.is_active %}<i class="fa fa-square green padd"></i>{% else %}<i class="fa fa-square red padd"></i>{% endif %}
        {{ client.first_name }} Savings Account
        {% if not user.is_admin %}
        <span style="margin-top:-3px;"><a href="#"><button class="ed-btn"><i class="fa fa-pencil-square-o padd"></i>Edit</button></a>
        </span>
        {% endif %}
      </h3>
    </div>
    <div class="panel-body">
      <!--panel body starts above-->
      <form class="form-horizontal" role="form">
      <!--div 1 0f form-->
      <div class="box-form">
        <div class="form-group grp-view">
          <label for="inputEmail3" class="col-lg-6 col-sm-6 control-label">Account Number:</label><span class="col-lg-6 mar-top">{{ savingsaccount.account_no }}</span>
        </div>
        <div class="form-group">
          <label for="inputEmail3" class="col-lg-6 col-sm-6 control-label">Applied By Staff :</label><span class="col-lg-6 mar-top">{{ savingsaccount.created_by|capfirst }}</span>
        </div>
        <div class="form-group">
          <label for="inputEmail3" class="col-lg-6 col-sm-6 control-label">Savings Balance :</label><span class="col-lg-6 mar-top" style="color:#FF00CC;">{{ savingsaccount.savings_balance }}</span>
        </div>
      </div>
      <!--div 1 of fomr ends above-->
      <!--div 2 of form starts below-->
      <div class="box-form">
        <div class="form-group">
          <label for="inputEmail3" class="col-lg-6 col-sm-6 control-label">Activation Date :</label><span class="col-lg-6 mar-top">{{ savingsaccount.opening_date }}</span>
        </div>
        <div class="form-group">
          <label for="inputEmail3" class="col-lg-6 col-sm-5 control-label">Status :</label>
          {% if savingsaccount.status == "Applied" %}
          <span class="col-lg-6 mar-top" style="color:#337ab7;">
          {% elif savingsaccount.status == "Withdrawn" %}
          <span class="col-lg-6 mar-top" style="color:#FF6600;">
          {% elif savingsaccount.status == "Approved" %}
          <span class="col-lg-6 mar-top" style="color:#008000;">
          {% elif savingsaccount.status == "Rejected" %}
          <span class="col-lg-6 mar-top red">
          {% elif savingsaccount.status == "Closed" %}
          <span class="col-lg-6 mar-top" style="color:#660099;">
          {% endif %}
          {{ savingsaccount.status }}</span>
        </div>
        <div class="form-group">
          <label for="inputEmail3" class="col-lg-6 col-sm-5 control-label">Annual Interest Rate :</label>
          <span class="col-lg-6 mar-top">
          {{ savingsaccount.annual_interest_rate }} %
          </span>
        </div>
      </div>
      <br clear="all" />
    </div>
    <!--panel body ends below crct-->
  </div>
</div>
<!--content ends above-->
<script src="/static/js/mf_script.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    $('#approve-button').click(function(e) {
      e.preventDefault();
      $.post('/approvesavings/'+$('#savingsaccount_id').val()+'/'+$('#client_id').val()+ '/', $('#clientsavingsaccountform').serialize(), function(data) {
        if (data.error) {
          alert("Savings Account Not Approved")
          window.location = '/clientsavingsaccount/'+data.client_id+'/';
        }
        else {
          alert("Approved successfully")
          window.location = '/clientsavingsaccount/'+data.client_id+'/';
        }

      }, "json");
    });
  });
  $(document).ready(function() {
    $('#withdraw-button').click(function(e) {
      e.preventDefault();
      $.post('/withdrawnsavings/'+$('#savingsaccount_id').val()+'/'+$('#client_id').val()+ '/', $('#clientsavingsaccountform').serialize(), function(data) {
        if (data.error) {
          alert("Savings Account cannot withdraw")
          window.location = '/clientsavingsaccount/'+data.client_id+'/';
        }
        else {
          alert("Withdrawn successfully")
          window.location = '/clientsavingsaccount/'+data.client_id+'/';
        }

      }, "json");
    });
  });
  $(document).ready(function() {
    $('#reject-button').click(function(e) {
      e.preventDefault();
      $.post('/rejectsavings/'+$('#savingsaccount_id').val()+'/'+$('#client_id').val()+ '/', $('#clientsavingsaccountform').serialize(), function(data) {
        if (data.error) {
          alert("Savings Account cannot reject")
          window.location = '/clientsavingsaccount/'+data.client_id+'/';
        }
        else {
          alert("Rejected successfully")
          window.location = '/clientsavingsaccount/'+data.client_id+'/';
        }

      }, "json");
    });
  });
</script>
{% endblock %}